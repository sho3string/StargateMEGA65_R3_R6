#!/bin/bash

WorkingDirectory=$(pwd)

nvram_table=(
	0x01 0x10 0x00 0x03 0x00 0x07 0x00 0x03 0x00 0x01 0x00 0x04 0x00 0x01 0x00 0x01 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x03 0x00 0x05 0x03 0x30 0x00 0x00 0x00 0x00 
	0x00 0x00 0x01 0x10 0x00 0x04 0x01 0x10 0x02 0x20 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x05 0x57 0x04 0x49 0x04 0x4C 0x04 0x4C 0x04 0x49 
	0x04 0x41 0x04 0x4D 0x05 0x53 0x02 0x20 0x04 0x45 0x04 0x4C 0x04 0x45 0x04 0x43 
	0x05 0x54 0x05 0x52 0x04 0x4F 0x04 0x4E 0x04 0x49 0x04 0x43 0x05 0x53 0x02 0x20 
	0x04 0x49 0x04 0x4E 0x04 0x43 0x03 0x3D 0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x20 
	0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x20 0x05 0x50 
	0x05 0x52 0x04 0x45 0x05 0x53 0x04 0x45 0x04 0x4E 0x05 0x54 0x05 0x53 0x03 0x3F 
	0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x20 0x02 0x25 0x02 0x25 0x05 0x5F 
	0x0D 0xD8 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
	0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0xBF 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 
	0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 
	0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 
	0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 
	0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 
	0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 
	0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 
	0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 
	0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 
	0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 
	0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 
	0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 
	0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 
	0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 
	0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 
	0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 
	0x00 0x00 0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 
	0x04 0x40 0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 
	0x00 0x00 0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 
	0x03 0x3A 0x03 0x3A 0x03 0x3A 0xFB 0x00 0x00 0x00 0x04 0x40 0x00 0x00 0x04 0x44 
	0x05 0x52 0x04 0x4A 0x00 0x00 0x00 0x03 0x06 0x64 0x04 0x40 0x04 0x4C 0x04 0x45 
	0x04 0x44 0x00 0x00 0x00 0x02 0x01 0x18 0x05 0x57 0x05 0x53 0x04 0x41 0x04 0x4D 
	0x00 0x00 0x00 0x01 0x09 0x95 0x05 0x55 0x05 0x53 0x05 0x53 0x05 0x52 0x00 0x00 
	0x00 0x01 0x04 0x45 0x06 0x65 0x04 0x45 0x05 0x50 0x04 0x4A 0x00 0x00 0x00 0x01 
	0x02 0x27 0x05 0x55 0x04 0x4A 0x04 0x45 0x05 0x52 0x00 0x00 0x00 0x01 0x02 0x27 
	0x05 0x50 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
 )

clear
echo ".----------------------."
echo "|Building stargate ROMs|"
echo "'----------------------'"

mkdir -p "$WorkingDirectory/arcade/stargate"

echo "Building CPU ROM"
cat 01 02 03 04 05 06 07 08 09 10 11 12 > "$WorkingDirectory/arcade/stargate/game.bin"
echo "Splitting Character ROM"

# Dumping nvram table
echo "Dumping nvram"
echo -ne "$(printf '\\x%02x' "${nvram_table[@]}")" > "$WorkingDirectory/arcade/stargate/nvram.bin"

# Copying sound ROMs
echo "Copying Sound ROMs"
cat sg.snd sg.snd > "$WorkingDirectory/arcade/stargate/sound.snd"

# Copying decoders
echo "Copying Decoders"
cp decoder.4 "$WorkingDirectory/arcade/stargate/"
cp decoder.5 "$WorkingDirectory/arcade/stargate/"

echo "Generating config file"
dd if=/dev/zero bs=1 count=33 | tr "\000" "\377" > "$WorkingDirectory/arcade/stargate/sgcfg"

echo "All Done!"